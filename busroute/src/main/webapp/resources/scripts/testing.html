<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
  <title>Waypoints in Directions</title>
  <style>
    #right-panel {
      font-family: 'Roboto','sans-serif';
      line-height: 30px;
      padding-left: 10px;
    }

    #right-panel select, #right-panel input {
      font-size: 15px;
    }

    #right-panel select {
      width: 100%;
    }

    #right-panel i {
      font-size: 12px;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #map {
      height: 100%;
      float: left;
      width: 70%;
      height: 100%;
    }
    #right-panel {
      margin: 20px;
      border-width: 2px;
      width: 20%;
      height: 400px;
      float: left;
      text-align: left;
      padding-top: 0;
    }
    #directions-panel {
      margin-top: 10px;
      background-color: #FFEE77;
      padding: 10px;
      overflow: scroll;
      height: 174px;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="right-panel">
    <div>
      <b>Start:</b>
      <select id="start">
        <option value="Halifax, NS">Halifax, NS</option>
        <option value="Boston, MA">Boston, MA</option>
        <option value="New York, NY">New York, NY</option>
        <option value="Miami, FL">Miami, FL</option>
      </select>
      <br>
      <b>Waypoints:</b> <br>
      <i>(Ctrl+Click or Cmd+Click for multiple selection)</i> <br>
      <select multiple id="waypoints">
        <option value="33.4984164,-86.8967907">Montreal, QB</option>
        <option value="toronto, ont">Toronto, ONT</option>
        <option value="chicago, il">Chicago</option>
        <option value="winnipeg, mb">Winnipeg</option>
        <option value="fargo, nd">Fargo</option>
        <option value="calgary, ab">Calgary</option>
        <option value="spokane, wa">Spokane</option>
      </select>
      <br>
      <b>End:</b>
      <select id="end">
        <option value="Vancouver, BC">Vancouver, BC</option>
        <option value="Seattle, WA">Seattle, WA</option>
        <option value="San Francisco, CA">San Francisco, CA</option>
        <option value="Los Angeles, CA">Los Angeles, CA</option>
      </select>
      <br>
      <input type="submit" id="submit">
    </div>
    <div id="directions-panel"></div>
  </div>
  <script>
    function initMap() {
      var directionsService = new google.maps.DirectionsService;
      var directionsRenderer = new google.maps.DirectionsRenderer;
      var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 6,
        center: {lat: 41.85, lng: -87.65}
      });
      directionsRenderer.setMap(map);

      var routes = [{"Time":"7:30 A.M.","Address":"Ave. C and 61st Street Back side of","Lat":"33.4984164","Long":"-86.8967907"},
      {"Time":"7:33 A.M.","Address":"Avenue C and Jerry D. Coleman","Lat":"33.4758812","Long":"-86.9173647"},
      {"Time":"7:35 A.M.","Address":"61st Street and Myron Massey Blvd.","Lat":"33.4769925","Long":"-86.9094935"},
      {"Time":"7:32 A.M.","Address":"60th Street and Myron Massey Blvd.","Lat":"33.4771589","Long":"-86.9093703"}];
   
   window.onload = calculateAndDisplayRoute(directionsService, directionsRenderer);

}

function calculateAndDisplayRoute(directionsService, directionsRenderer) {

  var routes = [{"Time":"7:30 A.M.","Address":"Ave. C and 61st Street Back side of","Lat":"33.4984164","Long":"-86.8967907"},{"Time":"7:33 A.M.","Address":"Avenue C and Jerry D. Coleman","Lat":"33.4758812","Long":"-86.9173647"},{"Time":"7:35 A.M.","Address":"61st Street and Myron Massey Blvd.","Lat":"33.4769925","Long":"-86.9094935"},{"Time":"7:32 A.M.","Address":"60th Street and Myron Massey Blvd.","Lat":"33.4771589","Long":"-86.9093703"},{"Time":"7:33 A.M.","Address":"Myron Massey Blvd. and 55th Place","Lat":"33.4827151","Long":"-86.9092874"},{"Time":"7:35 A.M.","Address":"Myron Massey Blvd. and 53rd Place","Lat":"33.4823689","Long":"-86.9092869"},{"Time":"7:37 A.M.","Address":"516 54th Street (Middle of the block)","Lat":"33.4842922","Long":"-86.9128126"},{"Time":"7:41 A.M.","Address":"54th and Avenue D","Lat":"33.4825863","Long":"-86.9116957"},{"Time":"7:43 A.M.","Address":"5174 Hillside Drive","Lat":"33.4868579","Long":"-86.9139871"},{"Time":"7:44 A.M.","Address":"721 Court G","Lat":"33.5299801","Long":"-86.8849877"},{"Time":"7:50 A.M.","Address":"Glen Oaks Elementary School","Lat":"33.4912583","Long":"-86.9104421"},{"Time":"3:45 P.M.","Address":"Glen Oaks Elementary School","Lat":"33.4912583","Long":"-86.9104421"},{"Time":"3:46 P.M.","Address":"5174 Hillside Drive","Lat":"33.4868579","Long":"-86.9139871"},{"Time":"3:49 P.M.","Address":"721 Court G","Lat":"33.5299801","Long":"-86.8849877"},{"Time":"3:51 P.M.","Address":"53rd Street and Court H","Lat":"33.4804248","Long":"-86.9064393"},{"Time":"3:52 P.M.","Address":"Myron Massey Blvd. and Court H","Lat":"33.482348","Long":"-86.9071609"},{"Time":"3:53 P.M.","Address":"Myron Massey Blvd. and 53rd Place","Lat":"33.4823689","Long":"-86.9092869"},{"Time":"3:54 P.M.","Address":"Myron Massey and 55th Place","Lat":"33.4827151","Long":"-86.9092874"},{"Time":"3:57 P.M.","Address":"516 54th Street (Middle of the block)","Lat":"33.4842922","Long":"-86.9128126"},{"Time":"3:58 P.M.","Address":"52nd Street and Avenue D","Lat":"33.485488","Long":"-86.91497"},{"Time":"3:59 P.M.","Address":"54th and Avenue D","Lat":"33.4825863","Long":"-86.9116957"},{"Time":"4:00 P.M.","Address":"55th and Avenue D","Lat":"33.482962","Long":"-86.912922"},{"Time":"4:04 P.M.","Address":"56TH Street and Terrace Avenue","Lat":"33.4822222","Long":"-86.9186264"},{"Time":"4:06 P.M.","Address":"60th Street and Terrace Avenue","Lat":"33.4773587","Long":"-86.9083505"},{"Time":"4:07 P.M.","Address":"Avenue C and Jerry D. Coleman","Lat":"33.477358","Long":"-86.9061628"},{"Time":"4:08 P.M.","Address":"Avenue D and Jerry D. Coleman","Lat":"33.4758712","Long":"-86.9159008"},{"Time":"4:09 P.M.","Address":"Court E and Jerry D. Coleman","Lat":"33.4758549","Long":"-86.9110933"}];
  let start = [];
  let end = [];
  let waypts = [];
  start.push(parseFloat(routes[0].Lat)+ ','+ parseFloat(routes[0].Long));
  end.push(parseFloat(routes[routes.length-1].Lat)+ ','+ parseFloat(routes[routes.length-1].Long));
  
  
  for (let j =1; j<routes.length-1;j++) {
    waypts.push({
      location: parseFloat(routes[j].Lat)+ ','+ parseFloat(routes[j].Long),
      stopover: true
    });
   
  };
  console.log('routes: ', start, end, waypts);
  directionsService.route({
    origin: start[0],
    destination: end[0],
    waypoints: waypts,
    optimizeWaypoints: true,
    travelMode: 'DRIVING'
  }, function(response, status) {
    if (status === 'OK') {
      directionsRenderer.setDirections(response);
          } else {
            window.alert('Directions request failed due to ' + status);
          }
        });
}
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBmUFlJbezVKywiLO6kZE3V2nsMuNR_F8s&callback=initMap">
</script>
</body>
</html>